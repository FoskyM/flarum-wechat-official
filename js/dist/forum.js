(()=>{var t={n:o=>{var a=o&&o.__esModule?()=>o.default:()=>o;return t.d(a,{a}),a},d:(o,a)=>{for(var e in a)t.o(a,e)&&!t.o(o,e)&&Object.defineProperty(o,e,{enumerable:!0,get:a[e]})},o:(t,o)=>Object.prototype.hasOwnProperty.call(t,o)};(()=>{"use strict";const o=flarum.core.compat["common/app"];t.n(o)().initializers.add("foskym/flarum-wechat-official",(function(){console.log("[foskym/flarum-wechat-official] Hello, forum and admin!")}));const a=flarum.core.compat["forum/app"];var e=t.n(a);const n=flarum.core.compat["common/extend"],c=flarum.core.compat["forum/components/NotificationGrid"];var r=t.n(c);const i=flarum.core.compat["forum/components/SettingsPage"];var s=t.n(i);const f=flarum.core.compat["common/components/Alert"];var u=t.n(f);const l=flarum.core.compat["common/components/Button"];var p=t.n(l);const h=flarum.core.compat["common/components/LinkButton"];var d=t.n(h);flarum.core.compat["common/components/Link"],flarum.core.compat["common/components/Page"],flarum.core.compat["common/helpers/icon"];const w=flarum.core.compat["common/models/User"];var k=t.n(w);const y=flarum.core.compat["common/Model"];var b=t.n(y);e().initializers.add("foskym/flarum-wechat-official",(function(){k().prototype.WechatAuth=b().attribute("WechatAuth"),(0,n.extend)(r().prototype,"notificationMethods",(function(t){e().forum.attribute("foskym-wechat-official.enable_push")&&t.add("push",{name:"push",icon:"fab fa-weixin",label:e().translator.trans("foskym-wechat-official.forum.settings.push_notification_label")})})),(0,n.extend)(s().prototype,"accountItems",(function(t){var o=this,a=e().forum.attribute("foskym-wechat-official.app_id"),n=e().forum.attribute("baseUrl")+"/wechat-official/callback",c="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+a+"&redirect_uri="+encodeURIComponent(n)+"&response_type=code&scope=snsapi_userinfo&state=wechat#wechat_redirect";t.add("wechat",this.user.WechatAuth().isLinked?m(p(),{icon:"fab fa-weixin",className:"Button Button--Wechat",onclick:function(){e().request({method:"POST",url:e().forum.attribute("apiUrl")+"/wechat-official/unlink"}).then((function(){o.user.WechatAuth().isLinked=!1,e().alerts.show(u(),{type:"success",children:e().translator.trans("foskym-wechat-official.forum.settings.wechat_unlink_success")}),m.redraw()}))}},e().translator.trans("foskym-wechat-official.forum.settings.wechat_unlink")):m(d(),{icon:"fab fa-weixin",className:"Button Button--Wechat",href:c,external:!0},this.user.WechatAuth().isLinked?e().translator.trans("foskym-wechat-official.forum.settings.wechat_linked"):e().translator.trans("foskym-wechat-official.forum.settings.bind_wechat")),-100)}))}))})(),module.exports={}})();
//# sourceMappingURL=forum.js.map